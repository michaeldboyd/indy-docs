
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Libindy 1.5 to 1.6 migration Guide &#8212; indy-docs 1.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">indy-docs 1.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <!-- markdownlint-disable MD033 --><div class="section" id="libindy-1-5-to-1-6-migration-guide">
<span id="libindy-1-5-to-1-6-migration-guide"></span><h1>Libindy 1.5 to 1.6 migration Guide<a class="headerlink" href="#libindy-1-5-to-1-6-migration-guide" title="Permalink to this headline">¶</a></h1>
<p>This document is written for developers using Libindy to provide necessary information and
to simplify their transition to Libindy 1.6 from Libindy 1.5. If you are using older Libindy
version you can check migration guides history:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/hyperledger/indy-sdk/blob/master/doc/migration-guide-1.3.0-1.4.0.md">Libindy 1.3 to 1.4 migration</a></li>
<li><a class="reference external" href="https://github.com/hyperledger/indy-sdk/blob/master/doc/migration-guide-1.4.0-1.5.0.md">Libindy 1.4 to 1.5 migration</a></li>
</ul>
<div class="section" id="table-of-contents">
<span id="table-of-contents"></span><h2>Table of contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="#notes">Notes</a></li>
<li><a class="reference external" href="#wallet-api">Wallet API</a></li>
<li><a class="reference external" href="#anoncreds-api">Anoncreds API</a></li>
<li><a class="reference external" href="#payments-api">Payments API</a></li>
<li><a class="reference external" href="#payments-api">Pool API</a></li>
<li><a class="reference external" href="#ledger-api">Ledger API</a></li>
</ul>
</div>
<div class="section" id="notes">
<span id="notes"></span><h2>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<p>Migration information is organized in tables, there are mappings for each Libindy API part of how older version functionality maps to a newer one.
Functions from older version are listed in the left column, and the equivalent newer version function is placed in the right column:</p>
<ul class="simple">
<li>If some function had been added, the word ‘NEW’ would be placed in the left column.</li>
<li>If some function had been deleted, the word ‘DELETED’ would be placed in the right column.</li>
<li>If some function had been deprecated, the word ‘DEPRECATED’ would be placed in the right column.</li>
<li>If some function had been changed, the current format would be placed in the right column.</li>
<li>If some function had not been changed, the symbol ‘=’ would be placed in the right column.</li>
<li>To get more details about current format of a function click on the description above it.</li>
<li>Bellow are signatures of functions in Libindy C API.
The params of <code class="docutils literal notranslate"><span class="pre">cb</span></code> (except command_handle and err) will be result values of the similar function in any Libindy wrapper.</li>
</ul>
<div class="section" id="wallet-api">
<span id="wallet-api"></span><h3>Wallet API<a class="headerlink" href="#wallet-api" title="Permalink to this headline">¶</a></h3>
<p>The main idea of changes performed in Wallet API is to avoid maintaining created wallet list on Libindy side.
It allows to access wallets from a cluster and solves some problems on mobile platforms.</p>
<p>The following changes have been performed:</p>
<ul class="simple">
<li>Changed Wallet export serialization:<ul>
<li>Use MsgPack instead of custom entities serialization to be more reliable and allow extend-ability in backward compatible way.</li>
<li>Changed header format to be more reliable and allow extend-ability in backward compatible way.</li>
<li>Use STOP message to make sure that there was no truncation of export file.</li>
<li>Removed EXPERIMENTAL notice for import/export API endpoints.</li>
</ul>
</li>
<li>Removed association between Wallet and Pool.</li>
<li>Removed persistence of Wallet configuration by Libindy.</li>
<li>A significant part of Wallet APIs has been updated to accept wallet configuration as a single json
which provides whole wallet configuration.
This wallet configuration json has the following format:</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> {
   &quot;id&quot;: string, Identifier of the wallet.
         Configured storage uses this identifier to lookup exact wallet data placement.
   &quot;storage_type&quot;: optional&lt;string&gt;, Type of the wallet storage. Defaults to &#39;default&#39;.
                  &#39;Default&#39; storage type allows to store wallet data in the local file.
                  Custom storage types can be registered with indy_register_wallet_storage call.
   &quot;storage_config&quot;: optional&lt;object&gt;, Storage configuration json. Storage type defines set of supported keys.
                     Can be optional if storage supports default configuration.
                     For &#39;default&#39; storage type configuration is:
   {
     &quot;path&quot;: optional&lt;string&gt;, Path to the directory with wallet files.
             Defaults to $HOME/.indy_client/wallets.
             Wallet will be stored in the file {path}/{id}/sqlite.db
   }
 }
</pre></div>
</div>
<ul class="simple">
<li>Updated wallet <code class="docutils literal notranslate"><span class="pre">credentials</span></code> to accept the additional parameter <code class="docutils literal notranslate"><span class="pre">key_derivation_method</span></code>.
This parameter provides the ability to use different crypto algorithms for master key derivation.
Wallet credentials json has the following format:</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="p">{</span>
   <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="n">string</span><span class="p">,</span> <span class="n">Passphrase</span> <span class="n">used</span> <span class="n">to</span> <span class="n">derive</span> <span class="n">wallet</span> <span class="n">master</span> <span class="n">key</span>
   <span class="s2">&quot;storage_credentials&quot;</span><span class="p">:</span> <span class="n">optional</span><span class="o">&lt;</span><span class="nb">object</span><span class="o">&gt;</span> <span class="n">Credentials</span> <span class="k">for</span> <span class="n">wallet</span> <span class="n">storage</span><span class="o">.</span> <span class="n">Storage</span> <span class="nb">type</span> <span class="n">defines</span> <span class="nb">set</span> <span class="n">of</span> <span class="n">supported</span> <span class="n">keys</span><span class="o">.</span>
                          <span class="n">Can</span> <span class="n">be</span> <span class="n">optional</span> <span class="k">if</span> <span class="n">storage</span> <span class="n">supports</span> <span class="n">default</span> <span class="n">configuration</span><span class="o">.</span>
                          <span class="n">For</span> <span class="s1">&#39;default&#39;</span> <span class="n">storage</span> <span class="nb">type</span> <span class="n">should</span> <span class="n">be</span> <span class="n">empty</span><span class="o">.</span>
   <span class="s2">&quot;key_derivation_method&quot;</span><span class="p">:</span> <span class="n">optional</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">algorithm</span> <span class="n">to</span> <span class="n">use</span> <span class="k">for</span> <span class="n">master</span> <span class="n">key</span> <span class="n">derivation</span><span class="p">:</span>
                          <span class="n">ARAGON2I_MOD</span> <span class="p">(</span><span class="n">used</span> <span class="n">by</span> <span class="n">default</span><span class="p">)</span>
                          <span class="n">ARAGON2I_INT</span> <span class="o">-</span> <span class="n">less</span> <span class="n">secured</span> <span class="n">but</span> <span class="n">faster</span> 
 <span class="p">}</span>
</pre></div>
</div>
<p><em>WARNING</em> Wallet format of libindy v1.6 isn’t compatible with a wallet format of libindy v1.5.</p>
<table>
  <tr>  
    <th>v1.5.0 - Wallet API</th>
    <th>v1.6.0 - Wallet API</th>
  </tr>
    <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/wallet.rs#L142">
            Create a new secure wallet
        </a>
    </th>
  <tr>
    <td>
      <pre>
indy_create_wallet(command_handle: i32,
                   pool_name: *const c_char,
                   name: *const c_char,
                   xtype: *const c_char,
                   config: *const c_char,
                   credentials: *const c_char,
                   cb: Option<extern fn(xcommand_handle: i32, err: ErrorCode)>)
      </pre>
    </td>
    <td>
      <pre>
indy_create_wallet(command_handle: i32,
                   config: *const c_char,
                   credentials: *const c_char,
                   cb: Option<extern fn(xcommand_handle: i32,
                                        err: ErrorCode)>)
      </pre>
      <b>Note:</b> Format of <i>config</i> parameter was changed. Current format is described above.
      <b>Note:</b> Format of <i>credentials</i> parameter was changed. Current format is described above.
    </td>
  </tr>
  </tr>
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/wallet.rs#L208">
            Open the wallet
        </a>
    </th>
  <tr>
    <td>
      <pre>
indy_open_wallet(command_handle: i32,
                 name: *const c_char,
                 runtime_config: *const c_char,
                 credentials_json: *const c_char,
                 cb: Option<extern fn(xcommand_handle: i32,
                                      err: ErrorCode,
                                      handle: i32)>)
      </pre>
    </td>
    <td>
      <pre>
indy_open_wallet(command_handle: i32,
                 config: *const c_char,
                 credentials: *const c_char,
                 cb: Option<extern fn(xcommand_handle: i32,
                                      err: ErrorCode,
                                      handle: i32)>)
      </pre>
      <b>Note:</b> Format of <i>config</i> parameter was changed. Current format is described above.
    </td>
  </tr>
    <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/wallet.rs#L443">
            Deletes created wallet
        </a>
    </th>
  <tr>
    <td>
      <pre>
indy_delete_wallet(command_handle: i32,
                   name: *const c_char,
                   credentials: *const c_char,
                   cb: Option<extern fn(xcommand_handle: i32, err: ErrorCode)>)
      </pre>
    </td>
    <td>
      <pre>
indy_delete_wallet(command_handle: i32,
                   config: *const c_char,
                   credentials: *const c_char,
                   cb: Option<extern fn(xcommand_handle: i32, err: ErrorCode)>)
      </pre>
      <b>Note:</b> Format of <i>config</i> parameter was changed. Current format is described above.
    </td>
  </tr>
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/wallet.rs#L328">
            Import wallet
        </a>
    </th>
  </tr>
  <tr>
    <td>
      <pre>
indy_import_wallet(
            command_handle: i32,
            pool_name: *const c_char,
            name: *const c_char,
            storage_type: *const c_char,
            config: *const c_char,
            credentials: *const c_char,
            import_config_json: *const c_char,
            cb: fn(xcommand_handle: i32, 
                   err: ErrorCode))
        </pre>
    </td>
    <td>
      <pre>
indy_import_wallet(
            command_handle: i32,
            config: *const c_char,
            credentials: *const c_char,
            import_config_json: *const c_char,
            cb: fn(xcommand_handle: i32, 
                   err: ErrorCode))
        </pre>
      <b>Note:</b> Format of <i>config</i> parameter was changed. Current format is described above.
    </td>
  </tr>
  <tr>
    <th colspan="2">
        <a href="">
            Lists created wallets
        </a>
    </th>
  </tr>
  <tr>
    <td>
      <pre>
indy_list_wallets(command_handle: i32,
                  cb: fn(xcommand_handle: i32,
                         err: ErrorCode,
                         wallets: *const c_char))
        </pre>
    </td>
    <td>
      <b>DELETED</b>
    </td>
  </tr>
</table></div>
<div class="section" id="anoncreds-api">
<span id="anoncreds-api"></span><h3>Anoncreds API<a class="headerlink" href="#anoncreds-api" title="Permalink to this headline">¶</a></h3>
<p>The main idea of changes performed in Anoncreds API is integration tags based search to Anoncreds workflow
as it has done in Non-Secrets API.</p>
<ul class="simple">
<li>Create tags for a stored object.</li>
<li>Provide efficient and flexible search for entities using WQL.</li>
<li>Avoid immediately returning all matched records.</li>
<li>Provide ability to fetch records by small batches.</li>
</ul>
<p>The following changes have been performed:</p>
<ul class="simple">
<li>Updated behavior of <code class="docutils literal notranslate"><span class="pre">indy_prover_store_credential</span></code> API function to create tags for a stored credential object.
Here is the list of tags will be created:</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;schema_id&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">credential</span> <span class="n">schema</span> <span class="nb">id</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s2">&quot;schema_issuer_did&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">credential</span> <span class="n">schema</span> <span class="n">issuer</span> <span class="n">did</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s2">&quot;schema_name&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">credential</span> <span class="n">schema</span> <span class="n">name</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s2">&quot;schema_version&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">credential</span> <span class="n">schema</span> <span class="n">version</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s2">&quot;issuer_did&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">credential</span> <span class="n">issuer</span> <span class="n">did</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s2">&quot;cred_def_id&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">credential</span> <span class="n">definition</span> <span class="nb">id</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="o">//</span> <span class="k">for</span> <span class="n">every</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">credential</span> <span class="n">values</span><span class="o">&gt;</span>
    <span class="s2">&quot;attr::&lt;attribute name&gt;::marker&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="o">//</span> <span class="n">to</span> <span class="n">check</span> <span class="n">existence</span> <span class="n">of</span> <span class="n">attribute</span>
    <span class="s2">&quot;attr::&lt;attribute name&gt;::value&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">attribute</span> <span class="n">raw</span> <span class="n">value</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">//</span> <span class="n">to</span> <span class="n">check</span> <span class="n">value</span> <span class="n">of</span> <span class="n">attribute</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">indy_prover_get_credential</span></code> was added to Libindy Anoncreds API to allow getting human readable credential by the given id.</li>
<li>Updated <code class="docutils literal notranslate"><span class="pre">indy_prover_get_credentials</span></code> and <code class="docutils literal notranslate"><span class="pre">indy_prover_get_credentials_for_proof_req</span></code> API functions to support tags based search.</li>
<li><code class="docutils literal notranslate"><span class="pre">indy_prover_get_credentials</span></code> endpoint marked as DEPRECATED and will be removed in the next release because immediately returns all fetched credentials.</li>
<li><code class="docutils literal notranslate"><span class="pre">indy_prover_get_credentials_for_proof_req</span></code> endpoint marked as DEPRECATED and will be removed in the next release because immediately returns all fetched credentials.</li>
<li>Added two chains of APIs related to credentials search that allows fetching records by batches:<ul>
<li>Simple credentials search - <code class="docutils literal notranslate"><span class="pre">indy_prover_search_credentials</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">indy_prover_fetch_credentials</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">indy_prover_close_credentials_search</span></code></li>
<li>Search credentials for proof request - <code class="docutils literal notranslate"><span class="pre">indy_prover_search_credentials_for_proof_req</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">indy_prover_fetch_credentials_for_proof_req</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">indy_prover_close_credentials_search_for_proof_req</span></code></li>
</ul>
</li>
</ul>
<p><strong>Note:</strong></p>
<ul class="simple">
<li>Functions <code class="docutils literal notranslate"><span class="pre">indy_prover_get_credentials</span></code> and <code class="docutils literal notranslate"><span class="pre">indy_prover_get_credentials_for_proof_req</span></code> support both formats of queries: old strict filter and WQL.</li>
<li>Functions <code class="docutils literal notranslate"><span class="pre">indy_prover_search_credentials</span></code> and <code class="docutils literal notranslate"><span class="pre">indy_prover_search_credentials_for_proof_req</span></code> support only WQL format of queries.</li>
</ul>
<p>References:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/hyperledger/indy-node/blob/master/docs/design/011-wallet-query-language/README.md">Wallet Query Language</a></li>
</ul>
<table>
  <tr>
    <th>v1.5.0 - Anoncreds API</th>
    <th>v1.6.0 - Anoncreds API</th>
  </tr>  
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/anoncreds.rs#L798">
            Gets human readable credential by the given id
        </a>
    </th>
  </tr>
  <tr>
    <td><b>NEW</b></td>
    <td>
      <pre>
indy_prover_get_credential(
            command_handle: i32,
            wallet_handle: i32,
            cred_id: *const c_char,
            cb: fn(xcommand_handle: i32, 
                   err: ErrorCode,
                   credential_json: *const c_char))
        </pre>
    </td>
  </tr>
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/anoncreds.rs#L855">
            Gets human readable credentials according to the filter
        </a>
    </th>
  </tr>
  <tr>
    <td>
      <pre>
indy_prover_get_credentials(
        command_handle: i32,
        wallet_handle: i32,
        filter_json: *const c_char,
        cb: fn(xcommand_handle: i32, 
               err: ErrorCode,
               credentials_json: *const c_char))
        </pre>
    </td>
    <td><b>DEPRECATED</b></td>
  </tr>
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/anoncreds.rs#L925">
            Search for credentials stored in wallet
        </a>
    </th>
  </tr>
  <tr>
    <td><b>NEW</b></td>
    <td colspan="2">
      <pre>
indy_prover_search_credentials(
            command_handle: i32,
            wallet_handle: i32,
            query_json: *const c_char,
            cb: fn(xcommand_handle: i32, 
                   err: ErrorCode,
                   search_handle: i32,
                   total_count: usize))
        </pre>
    </td>
  </tr>  
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/anoncreds.rs#L980">
            Fetch next credentials for search
        </a>
    </th>
  </tr>
  <tr>
    <td><b>NEW</b></td>
    <td colspan="2">
      <pre>
indy_prover_fetch_credentials(
            command_handle: i32,
            search_handle: i32,
            count: usize,
            cb: fn(command_handle_: i32, 
                   err: ErrorCode,
                   credentials_json: *const c_char))
        </pre>
    </td>
  </tr> 
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/anoncreds.rs#L1036">
            Close credentials search
        </a>
    </th>
  </tr>
  <tr>
    <td><b>NEW</b></td>
    <td colspan="2">
      <pre>
indy_prover_close_credentials_search(
            command_handle: i32,
            search_handle: i32,
            cb: fn(command_handle_: i32, 
                   err: ErrorCode))
        </pre>
    </td>
  </tr>
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/anoncreds.rs#L1074">
            Gets human readable credentials matching the given proof request
        </a>
    </th>
  </tr>
  <tr>
    <td>
      <pre>
indy_prover_get_credentials_for_proof_req(
        command_handle: i32,
        wallet_handle: i32,
        proof_request_json: *const c_char,
        cb: fn(xcommand_handle: i32, 
               err: ErrorCode,
               credentials_json: *const c_char))
        </pre>
    </td>
    <td><b>DEPRECATED</b></td>
  </tr>
  <tr>
    <th colspan="2">
      <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/anoncreds.rs#L1191">
        Search for credentials matching the given proof request.
      </a>
    </th>
  </tr>
  <tr>
    <td><b>NEW</b></td>
    <td>
      <pre>
indy_prover_search_credentials_for_proof_req(
            command_handle: i32,
            wallet_handle: i32,
            proof_request_json: *const c_char,
            extra_query_json: *const c_char,
            cb: fn(xcommand_handle: i32, 
                   err: ErrorCode,
                   search_handle: i32))
      <b>NOTE:</b> Added parameter <b>extra_query_json</b>.
      Using this parameter you can pass an additional 
      query to any attribute/predicate in a proof request.
      </pre>
    </td>
  </tr>
  <tr>
    <th colspan="2">
      <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/anoncreds.rs#L1270">
        Fetch next credentials for the requested item using proof request search handle
      </a>
    </th>
  </tr>
  <tr>
    <td><b>NEW</b></td>
    <td>
      <pre>
indy_prover_fetch_credentials_for_proof_req(
            command_handle: i32,
            search_handle: i32,
            item_referent: *const c_char,
            count: usize,
            cb: fn(command_handle_: i32, 
                   err: ErrorCode,
                   credentials_json: *const c_char))
      </pre>
    </td>
  </tr>
  <tr>
    <th colspan="2">
      <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/anoncreds.rs#L1343">
        Close credentials search for proof request
      </a>
    </th>
  </tr>
  <tr>
    <td><b>NEW</b></td>
    <td>
      <pre>
indy_prover_close_credentials_search_for_proof_req(
            command_handle: i32,
            search_handle: i32,
            cb: fn(command_handle_: i32, 
                   err: ErrorCode))
      </pre>
    </td>
  </tr>
</table></div>
<div class="section" id="payments-api">
<span id="payments-api"></span><h3>Payments API<a class="headerlink" href="#payments-api" title="Permalink to this headline">¶</a></h3>
<p>The main idea of changes performed in Payment API is avoiding UTXO based payments approach.
Payment API has been updated to support non-UTXO based crypto payments and traditional payments like VISA.</p>
<p><strong>Note:</strong> Removed EXPERIMENTAL notice for API endpoints.</p>
<p>The following changes have been performed:</p>
<ul class="simple">
<li>Changed format of input and output parameters.</li>
<li>Changed format of result values of <code class="docutils literal notranslate"><span class="pre">indy_parse_response_with_fees</span></code> and <code class="docutils literal notranslate"><span class="pre">indy_parse_payment_response</span></code> API functions.</li>
<li>Renamed <code class="docutils literal notranslate"><span class="pre">indy_build_get_utxo_request</span></code> and <code class="docutils literal notranslate"><span class="pre">indy_parse_get_utxo_response</span></code> API functions.</li>
<li>Added <code class="docutils literal notranslate"><span class="pre">indy_build_verify_payment_req</span></code> and <code class="docutils literal notranslate"><span class="pre">indy_parse_verify_payment_response</span></code> API functions.</li>
</ul>
<table>
  <tr>
    <th>v1.5.0 - Payment API</th>
    <th>v1.6.0 - Payment API</th>
  </tr>  
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/payments.rs#L505">
            Modifies Indy request by adding information how to pay fees for this transaction
            according to selected payment method
        </a>
    </th>
  </tr>
  <tr>
    <td>
      <pre>
indy_add_request_fees(
        command_handle: i32,
        wallet_handle: i32,
        submitter_did: *const c_char,
        req_json: *const c_char,
        inputs_json: *const c_char,
        outputs_json: *const c_char,
        cb: fn(command_handle_: i32,
               err: ErrorCode,
               req_with_fees_json: *const c_char,
               payment_method: *const c_char))
      </pre>
    </td>
    <td>
<pre>
Left the same but the format of outputs has been 
changed to:
[{
  recipient: <str>, // payment address of recipient
  amount: <int>, // amount
  extra: <str>, // optional data
}]
      </pre>
    </td>
  </tr>
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/payments.rs#L585">
            Parses response for Indy request with fees
        </a>
    </th>
  </tr>
  <tr>
    <td>
      <pre>
indy_parse_response_with_fees(
        command_handle: i32,
        payment_method: *const c_char,
        resp_json: *const c_char,
        cb: fn(command_handle_: i32,
               err: ErrorCode,
               utxo_json: *const c_char))
      </pre>
    </td>
    <td>
    <pre>
indy_parse_response_with_fees(
        command_handle: i32,
        payment_method: *const c_char,
        resp_json: *const c_char,
        cb: fn(command_handle_: i32,
               err: ErrorCode,
               receipts_json: *const c_char))
<b>NOTE:</b> Format of result value has been changed to:
[{
   receipt: <str>, // receipt that can be used for 
             payment referencing and verification
   recipient: <str>, //payment address of recipient
   amount: <int>, // amount
   extra: <str>, // optional data from payment transaction
}]
      </pre>
    </td>
  </tr>
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/payments.rs#L632">
             Builds Indy request for getting sources list for payment address
             according to this payment method
        </a>
    </th>
  </tr>
  <tr>
    <td>
      <pre>
indy_build_get_utxo_request(
        command_handle: i32,
        wallet_handle: i32,
        submitter_did: *const c_char,
        payment_address: *const c_char,
        cb: fn(command_handle_: i32,
               err: ErrorCode,
               get_utxo_txn_json: *const c_char,
               payment_method: *const c_char))
      </pre>
    </td>
    <td>
    <pre>
indy_build_get_sources_request(
        command_handle: i32,
        wallet_handle: i32,
        submitter_did: *const c_char,
        payment_address: *const c_char,
        cb: fn(command_handle_: i32,
               err: ErrorCode,
               get_sources_txn_json: *const c_char,
               payment_method: *const c_char))
    </pre>
<b>NOTE:</b> Function and result value have been renamed.
    </td>
  </tr>
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/payments.rs#L683">
             Parses response for Indy request for getting sources list
        </a>
    </th>
  </tr>
  <tr>
    <td>
      <pre>
indy_parse_get_utxo_response(
        command_handle: i32,
        payment_method: *const c_char,
        resp_json: *const c_char,
        cb: fn(command_handle_: i32,
               err: ErrorCode,
               utxo_json: *const c_char))
      </pre>
    </td>
    <td>
    <pre>
indy_parse_get_sources_response(
        command_handle: i32,
        payment_method: *const c_char,
        resp_json: *const c_char,
        cb: fn(command_handle_: i32,
               err: ErrorCode,
               sources_json: *const c_char))
<b>NOTE:</b> Function and result value have been renamed.
<b>NOTE:</b> sources have the following format:
[{
   source: <str>, // source input
   paymentAddress: <str>, //payment address for this source
   amount: <int>, // amount
   extra: <str>, // optional data from payment transaction
}]
      </pre>
    </td>
  </tr>
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/payments.rs#L733">
             Builds Indy request for doing payment according to this payment method
        </a>
    </th>
  </tr>
  <tr>
    <td>
      <pre>
indy_build_payment_req(
        command_handle: i32,
        wallet_handle: i32,
        submitter_did: *const c_char,
        inputs_json: *const c_char,
        outputs_json: *const c_char,
        cb: fn(command_handle_: i32,
               err: ErrorCode,
               payment_req_json: *const c_char,
               payment_method: *const c_char))
      </pre>
    </td>
    <td>
<pre>
Left the same but the format of outputs has been 
changed to:
[{
  recipient: <str>, // payment address of recipient
  amount: <int>, // amount
  extra: <str>, // optional data
}]
      </pre>
    </td>
  </tr>
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/payments.rs#L805">
             Builds Indy request for doing payment according to this payment method
        </a>
    </th>
  </tr>
  <tr>
    <td>
      <pre>
indy_parse_payment_response(
            command_handle: i32,
            payment_method: *const c_char,
            resp_json: *const c_char,
            cb: fn(command_handle_: i32,
                   err: ErrorCode,
                   utxo_json: *const c_char))
      </pre>
    </td>
    <td>
      <pre>
indy_parse_payment_response(
            command_handle: i32,
            payment_method: *const c_char,
            resp_json: *const c_char,
            cb: fn(command_handle_: i32,
                   err: ErrorCode,
                   receipts_json: *const c_char))
<b>NOTE:</b> Format of result value has been changed to:
[{
   receipt: <str>, // receipt that can be used for 
             payment referencing and verification
   recipient: <str>, //payment address of recipient
   amount: <int>, // amount
   extra: <str>, // optional data from payment transaction
}]
      </pre>
    </td>
  </tr>
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/payments.rs#L855">
             Builds Indy request for doing tokens minting according to this payment method
        </a>
    </th>
  </tr>
  <tr>
    <td>
      <pre>
indy_build_mint_req(
        command_handle: i32,
        wallet_handle: i32,
        submitter_did: *const c_char,
        outputs_json: *const c_char,
        cb: fn(command_handle_: i32,
               err: ErrorCode,
               mint_req_json: *const c_char,
               payment_method: *const c_char))
      </pre>
    </td>
    <td>
<pre>
Left the same but the format of outputs has been 
changed to:
[{
  recipient: <str>, // payment address of recipient
  amount: <int>, // amount
  extra: <str>, // optional data
}]
      </pre>
    </td>
  </tr>
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/payments.rs#L1065">
             Builds Indy request for information to verify the payment receipt
        </a>
    </th>
  </tr>
  <tr>
    <td><b>NEW</b></td>
    <td>
      <pre>
indy_build_verify_payment_req(
        command_handle: i32,
        wallet_handle: i32,
        submitter_did: *const c_char,
        receipt: *const c_char,
        cb: fn(command_handle_: i32,
               err: ErrorCode,
               verify_txn_json: *const c_char,
               payment_method: *const c_char))
      </pre>
    </td>
  </tr>
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/payments.rs#L1114">
             Parses Indy response with information to verify receipt
        </a>
    </th>
  </tr>
  <tr>
    <td><b>NEW</b></td>
    <td>
      <pre>
indy_parse_verify_payment_response(
        command_handle: i32,
        payment_method: *const c_char,
        resp_json: *const c_char,
        cb: fn(command_handle_: i32,
               err: ErrorCode,
               txn_json: *const c_char))
      </pre>
    </td>
  </tr>
</table></div>
<div class="section" id="pool-api">
<span id="pool-api"></span><h3>Pool API<a class="headerlink" href="#pool-api" title="Permalink to this headline">¶</a></h3>
<table>
  <tr>
    <th>v1.5.0 - Pool API</th>
    <th>v1.6.0 - Pool API</th>
  </tr>  
  <tr>
    <th colspan="2">
        <a href="https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/pool.rs#L59">
            Opens pool ledger and performs connecting to pool nodes
        </a>
    </th>
  </tr>
  <tr>
    <td>
      <pre>
indy_open_pool_ledger(command_handle: i32,
                      config_name: *const c_char,
                      config: *const c_char,
                      cb: fn(xcommand_handle: i32,
                           err: ErrorCode,
                           pool_handle: i32))
      </pre>
    </td>
    <td>
<pre>
Left the same but the format of config has been changed to:
{
   "timeout": int (optional), timeout for network request (in sec).
   "extended_timeout": int (optional), extended timeout for network request (in sec).
   "preordered_nodes": array<string> - (optional), names of nodes which will 
       have a priority during request sending:
       ["name_of_1st_prior_node",  "name_of_2nd_prior_node", .... ]
       Note: Not specified nodes will be placed in a random way.
}
      </pre>
    </td>
  </tr>
</table></div>
<div class="section" id="ledger-api">
<span id="ledger-api"></span><h3>Ledger API<a class="headerlink" href="#ledger-api" title="Permalink to this headline">¶</a></h3>
<table>
  <tr>
    <th>v1.5.0 - Ledger API</th>
    <th>v1.6.2 - Ledger API</th>
  </tr>  
  <tr>
    <th colspan="2">
        <a https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/ledger.rs#L122">
            Send action to particular nodes of validator pool
        </a>
    </th>
  </tr>
  <tr>
    <td><b>NEW</b></td>
    <td>
      <pre>
indy_submit_action(command_handle: i32,
                   pool_handle: i32,
                   request_json: *const c_char,
                   nodes: *const c_char,
                   timeout: i32,
                   cb: fn(xcommand_handle: i32,
                          err: ErrorCode,
                          request_result_json: *const c_char))
      </pre>
    </td>
  </tr>
  <tr>
    <th colspan="2">
        <a https://github.com/hyperledger/indy-sdk/blob/master/libindy/src/api/ledger.rs#L1148">
            Builds a POOL_UPGRADE request
        </a>
    </th>
  </tr>
  <tr>
      <pre>
indy_build_pool_upgrade_request(command_handle: i32,
                                submitter_did: *const c_char,
                                name: *const c_char,
                                version: *const c_char,
                                action: *const c_char,
                                sha256: *const c_char,
                                timeout: i32,
                                schedule: *const c_char,
                                justification: *const c_char,
                                reinstall: bool,
                                force: bool,
                                cb: fn(xcommand_handle: i32,
                                       err: ErrorCode,
                                       request_json: *const c_char))
      </pre>
    <td>
      <pre>
indy_build_pool_upgrade_request(command_handle: i32,
                                submitter_did: *const c_char,
                                name: *const c_char,
                                version: *const c_char,
                                action: *const c_char,
                                sha256: *const c_char,
                                timeout: i32,
                                schedule: *const c_char,
                                justification: *const c_char,
                                reinstall: bool,
                                force: bool,
                                package: *const c_char,
                                cb: fn(xcommand_handle: i32,
                                       err: ErrorCode,
                                       request_json: *const c_char))
      </pre>
      <b>Note:</b> Added <i>package</i> parameter that allows to specify package to be upgraded
    </td>
  </tr>
</table></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Libindy 1.5 to 1.6 migration Guide</a><ul>
<li><a class="reference internal" href="#table-of-contents">Table of contents</a></li>
<li><a class="reference internal" href="#notes">Notes</a><ul>
<li><a class="reference internal" href="#wallet-api">Wallet API</a></li>
<li><a class="reference internal" href="#anoncreds-api">Anoncreds API</a></li>
<li><a class="reference internal" href="#payments-api">Payments API</a></li>
<li><a class="reference internal" href="#pool-api">Pool API</a></li>
<li><a class="reference internal" href="#ledger-api">Ledger API</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/indy-sdk/v1.6.2/doc/migration-guide-1.5.0-1.6.0.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">indy-docs 1.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Michael McKean.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>