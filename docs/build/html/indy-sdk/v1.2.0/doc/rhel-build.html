
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Setup Indy SDK build environment for RHEL based distro (Amazon Linux 2017.03) &#8212; indy-docs 1.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">indy-docs 1.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="setup-indy-sdk-build-environment-for-rhel-based-distro-amazon-linux-2017-03">
<span id="setup-indy-sdk-build-environment-for-rhel-based-distro-amazon-linux-2017-03"></span><h1>Setup Indy SDK build environment for RHEL based distro (Amazon Linux 2017.03)<a class="headerlink" href="#setup-indy-sdk-build-environment-for-rhel-based-distro-amazon-linux-2017-03" title="Permalink to this headline">¶</a></h1>
<ol>
<li><p class="first">Install Rust and rustup (https://www.rust-lang.org/install.html).</p>
</li>
<li><p class="first">Install required native libraries and utilities available in repos:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">yum</span> <span class="n">clean</span> <span class="nb">all</span>
<span class="n">yum</span> <span class="n">upgrade</span> <span class="o">-</span><span class="n">y</span>
<span class="n">yum</span> <span class="n">groupinstall</span> <span class="o">-</span><span class="n">y</span> <span class="s2">&quot;Development Tools&quot;</span>
<span class="n">yum</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> \
    <span class="n">wget</span> \
    <span class="n">cmake</span> \
    <span class="n">pkgconfig</span> \
    <span class="n">openssl</span><span class="o">-</span><span class="n">devel</span> \
    <span class="n">sqlite</span><span class="o">-</span><span class="n">devel</span>
</pre></div>
</div>
</li>
<li><p class="first">Build and install modern version of libsodium from sources:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd /tmp
curl https://download.libsodium.org/libsodium/releases/libsodium-1.0.12.tar.gz | tar -xz
cd /tmp/libsodium-1.0.12
./configure
make
make install
rm -rf /tmp/libsodium-1.0.12

export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/local/lib/pkgconfig
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/lib
</pre></div>
</div>
</li>
<li><p class="first">Checkout and build the library:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">checkout</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">hyperledger</span><span class="o">/</span><span class="n">indy</span><span class="o">-</span><span class="n">sdk</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="o">./</span><span class="n">indy</span><span class="o">-</span><span class="n">sdk</span>
<span class="n">cargo</span> <span class="n">build</span>
</pre></div>
</div>
</li>
<li><p class="first">Run integration tests:</p>
<ul>
<li><p class="first">Start local nodes pool on <code class="docutils literal notranslate"><span class="pre">127.0.0.1:9701-9708</span></code> with Docker:</p>
<div class="highlight- notranslate"><div class="highlight"><pre><span></span>docker build -f ci/indy-pool.dockerfile -t indy_pool .
docker run -itd -p 9701-9709:9701-9709 indy_pool
</pre></div>
</div>
<p>In some environments, this approach with mapping of local ports to container ports
can’t be applied. Dockerfile <code class="docutils literal notranslate"><span class="pre">ci/indy-pool.dockerfile</span></code> supports optional pool_ip param
that allows changing ip of pool nodes in generated pool configuration. The following
commands allow to start local nodes pool in custom docker network and access this pool by
custom ip in docker network:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">network</span> <span class="n">create</span> <span class="o">--</span><span class="n">subnet</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">8</span> <span class="n">indy_pool_network</span>
<span class="n">docker</span> <span class="n">build</span> <span class="o">--</span><span class="n">build</span><span class="o">-</span><span class="n">arg</span> <span class="n">pool_ip</span><span class="o">=</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span> <span class="o">-</span><span class="n">f</span> <span class="n">ci</span><span class="o">/</span><span class="n">indy</span><span class="o">-</span><span class="n">pool</span><span class="o">.</span><span class="n">dockerfile</span> <span class="o">-</span><span class="n">t</span> <span class="n">indy_pool</span> <span class="o">.</span>
<span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">d</span> <span class="o">--</span><span class="n">ip</span><span class="o">=</span><span class="s2">&quot;10.0.0.2&quot;</span> <span class="o">--</span><span class="n">net</span><span class="o">=</span><span class="n">indy_pool_network</span> <span class="n">indy_pool</span>
</pre></div>
</div>
<p>It can be usefull if we wants to launch integration tests inside another container attached to
the same docker network.</p>
</li>
<li><p class="first">Run tests</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RUST_TEST_THREADS</span><span class="o">=</span><span class="mi">1</span> <span class="n">cargo</span> <span class="n">test</span>
</pre></div>
</div>
<p>It is possible to change ip of test pool by providing of TEST_POOL_IP environment variable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RUST_TEST_THREADS</span><span class="o">=</span><span class="mi">1</span> <span class="n">TEST_POOL_IP</span><span class="o">=</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.2</span> <span class="n">cargo</span> <span class="n">test</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ol>
<p>See <a class="reference external" href="https://github.com/hyperledger/indy-sdk/tree/master/ci/amazon.dockerfile">ci/amazon.dockerfile</a> for example of Amazon Linux based environment creation in Docker.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/indy-sdk/v1.2.0/doc/rhel-build.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">indy-docs 1.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Michael McKean.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>